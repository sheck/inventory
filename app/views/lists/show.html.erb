<h1><%= @list.name %></h1>

<%= link_to "Edit list name", edit_list_path(@list) %>&nbsp;&nbsp;&nbsp;
<%= link_to "Delete list", @list, method: :delete,
    data: { confirm: 'Are you sure?' } %>

<p>&nbsp;</p>
<%= simple_form_for @item do |f| %>
  <%= f.error_notification %>
  <%= f.hidden_field :return_to, value: list_path(@list.id) %>
  <div class="row">
    <div class="col-xs-10">
      <%= f.input :name, label: "Item name", placeholder: "Enter new item name...",
                  label_html: { class: 'sr-only' }, autofocus: true %>
      <%= f.input :description, placeholder: "Enter optional description...",
                  label_html: { class: 'sr-only' },
                  input_html: { class: 'invisi-field' }  %>
    </div>
    <div class="col-xs-2">
      <%= f.button :submit, "+", title: "Create item and add to list", class: "btn-block" %>
    </div>
    <%= f.simple_fields_for(:list_assignments) do |la| %>
      <%= la.hidden_field :list_id, value: @list.id %>
    <% end %>
  </div>
<% end %>
<p>&nbsp;</p>

<table class="table list-items">
  <tbody>
    <% @items.each do |item| %>
      <tr id="<%= dom_id(item) %>">
        <td>
          <strong><%= link_to item.name, item %></strong><br>
          <%= item.description %>
        </td>
        <td class="small-col">
          <%= link_to list_assignment_path(item.list_assignments.where(list: @list).pluck(:id)), method: :delete, title: "Remove from list", class: "btn btn-default"  do %>
            <i class="fa fa-times"></i>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<% unless @other_items.empty? %>
  <p>&nbsp;</p>

  <hr>

  <p>&nbsp;</p>

  <h3 class="text-center">Other items not on this list</h3>

  <table class="table">
    <thead>
      <tr>
        <th>Item</th>
        <th>Add to list</th>
      </tr>
    </thead>
    <tbody>
      <% @other_items.each do |item| %>
        <tr id="<%= dom_id(item) %>">
          <td>
            <strong><%= link_to item.name, item %></strong><br>
            <%= item.description %>
          </td>
          <td class="small-col">
            <%= button_to item_list_assignments_path(item),
              params: { list_id: @list.id }, title: "Add to list", class: "btn btn-default" do %>
              <i class="fa fa-plus"></i>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
